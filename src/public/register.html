<html>
  <title>Registration Page</title>
</html>
<body>
  <form onsubmit="return false">
    <label for="firstName">First Name</label>
    <input type="text" name="firstName" id="firstName" />
    <br />
    <label for="lastName">Last Name</label>
    <input type="text" name="lastName" id="lastName" />
    <br />
    <label for="email">Email</label>
    <input type="email" name="email" id="email" />
    <br />
    <label for="password">Password</label>
    <input type="password" name="password" id="password" />
    <br />
    <button type="submit" onclick="register()">Register</button>
    <br />
    <a href="/index.html">Already have an account? Login here.</a>
  </form>
  <script>
    async function register() {
      try {
        const credentials = {
          firstName: document.forms[0].elements[0].value,
          lastName: document.forms[0].elements[1].value,
          email: document.forms[0].elements[2].value,
          password: document.forms[0].elements[3].value,
        };
        const response = await fetch('/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(credentials),
        }).then(response => response.json());
        if (!response.user) {
          throw new Error('Registration Failed');
        }
        localStorage.setItem(
          'game-exercise-user',
          JSON.stringify(response.user),
        );
        window.location.replace('/game.html');
      } catch (error) {
        localStorage.removeItem('game-exercise-user');
        alert('Registration failed');
      }
    }
  </script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.0.0/dist/fetch.umd.min.js"
  ></script>
</body>
